// Generated by CoffeeScript 1.9.1
(function() {
  AdminApp.Views.categoryParameters = Backbone.View.extend({
    el: '#edit-categories-form',
    $elParams: $('#category-edit-parameters'),
    $elLabels: $('#parameters-links'),
    $elSearchParams: $('#category-edit-searchparameters'),
    initialize: function() {
      var addSearchTag, deleteLabel, insertLabel;
      console.log('Initialize categoryParameters view');
      insertLabel = (function(_this) {
        return function(tagname) {
          var label;
          console.log('insertLabel');
          label = "<a href='#' class='label label-primary parameter-label'>" + tagname + "</a> ";
          return _this.$elLabels.append(label);
        };
      })(this);
      deleteLabel = (function(_this) {
        return function(tagname) {
          _this.$elLabels.find('a:contains(' + tagname + ')').remove();
          return _this.$elSearchParams.removeTag(tagname);
        };
      })(this);
      addSearchTag = (function(_this) {
        return function(tagname) {
          if (!_this.$elParams.tagExist(tagname)) {
            return _this.$elSearchParams.removeTag(tagname);
          }
        };
      })(this);
      this.$elParams.tagsInput({
        'width': '100%',
        'defaultText': 'добавить параметр',
        'onAddTag': function(tagname) {
          return insertLabel(tagname);
        },
        'onRemoveTag': function(tagname) {
          return deleteLabel(tagname);
        }
      });
      return this.$elSearchParams.tagsInput({
        'width': '100%',
        'defaultText': '',
        'onAddTag': function(tagname) {
          return addSearchTag(tagname);
        }
      });
    },
    events: {
      'click .parameter-label': 'clickParameterLebel'
    },
    clickParameterLebel: function(e) {
      var el, tag;
      e.preventDefault();
      el = $(e.target);
      tag = el.html();
      if (!this.$elSearchParams.tagExist(tag)) {
        return this.$elSearchParams.addTag(tag);
      } else {
        return console.log('Параметр уже существует');
      }
    }
  });

  AdminApp.initViews.categoryParameters = new AdminApp.Views.categoryParameters();

}).call(this);
