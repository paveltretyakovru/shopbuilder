// Generated by CoffeeScript 1.9.0
var AdminApp;

AdminApp = {
  Views: {},
  Collections: {},
  Models: {},
  initViews: {},
  initModels: {},
  initCollections: {}
};

AdminApp.Views.categoryParameters = Backbone.View.extend({
  el: '#edit-categories-form',
  $elParams: $('#category-edit-parameters'),
  $elLabels: $('#parameters-links'),
  $elSearchParams: $('#category-edit-searchparameters'),
  parameters: [],
  searchParameters: [],
  events: {
    'keypress #category-edit-parameters': 'enterText',
    'click .parameter-label': 'clickParameterLebel'
  },
  enterText: function(e) {
    this.parameters = [];
    this.updateParameters(this.$elParams, this.parameters);
    return this.insertLabels();
  },
  updateParameters: function(el, array) {
    var parameter, parameters, _i, _len, _results;
    parameters = el.val().split(',');
    _results = [];
    for (_i = 0, _len = parameters.length; _i < _len; _i++) {
      parameter = parameters[_i];
      _results.push(this.addParameter(parameter, array));
    }
    return _results;
  },
  addParameter: function(parameter, array) {
    parameter = $.trim(parameter);
    if (array.indexOf(parameter) === -1 && parameter !== '') {
      return array.push(parameter);
    }
  },
  insertLabels: function() {
    var createLink, parameter, string, _i, _len, _ref;
    console.log(this.parameters);
    string = "";
    createLink = function(parameter) {
      return "<a href='#' class='label label-primary parameter-label'>" + parameter + "</a>&nbsp;";
    };
    _ref = this.parameters;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      parameter = _ref[_i];
      string += createLink(parameter);
    }
    return this.$elLabels.html(string);
  },
  insertSearchParameter: function() {},
  clickParameterLebel: function(e) {
    var el, join_parameters;
    e.preventDefault();
    el = $(e.target);
    this.$elSearchParams.html(this.$elSearchParams.html() + ',' + el.html());
    this.searchParameters = [];
    this.updateParameters(this.$elSearchParams, this.searchParameters);
    join_parameters = this.searchParameters.join();
    return this.$elSearchParams.html(join_parameters);
  }
});

AdminApp.initViews.categoryParameters = new AdminApp.Views.categoryParameters();
